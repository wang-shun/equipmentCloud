webpackJsonp([6],{BOwp:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.btn_right{\n  float: right;\n}\n.block {\n  margin-top: 15px;\n}\n",""])},ESmb:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n@keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n@-webkit-keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n",""])},G3lA:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n.ms-tree-space[data-v-49a33177] {\n  position: relative;\n  top: 1px;\n  display: inline-block;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1;\n  width: 18px;\n  height: 14px;\n}\n.ms-tree-space[data-v-49a33177]::before {\n    content: "";\n}\n.processContainer[data-v-49a33177] {\n  width: 100%;\n  height: 100%;\n}\ntable td[data-v-49a33177] {\n  line-height: 26px;\n}\n.tree-ctrl[data-v-49a33177] {\n  position: relative;\n  cursor: pointer;\n  color: #2196F3;\n  margin-left: -18px;\n}\n',""])},UF1S:function(t,e,a){var i=a("BOwp");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("2f5eeb18",i,!0)},aokj:function(t,e,a){var i=a("ESmb");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("a55bc048",i,!0)},iNUo:function(t,e,a){var i=a("G3lA");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("77bafa32",i,!0)},rKL6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),s=a("cAgV"),o=a("dXij"),l=a.n(o),r=a("c/Tr"),c=a.n(r),d=a("/5sW");function p(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[];return c()(t).forEach(function(t){void 0===t._expanded&&d.default.set(t,"_expanded",e);var s=1;if(void 0!==i&&null!==i&&(s=i+1),d.default.set(t,"_level",s),a&&d.default.set(t,"parent",a),n.push(t),t.childList&&t.childList.length>0){var o=p(t.childList,e,t,s);n=n.concat(o)}}),n}var u=[{value:1,label:"公司"},{value:2,label:"单位"},{value:3,label:"部门"}].reduce(function(t,e){return t[e.value]=e.label,t},{}),m={name:"TreeTableForJurisdiction",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},filters:{isType:function(t){return u[t]}},computed:{formatData:function(){var t=void 0;t=Array.isArray(this.data)?this.data:[this.data];var e=this.evalFunc||p,a=this.evalArgs?l()([t,this.expandAll],this.evalArgs):[t,this.expandAll];return e.apply(null,a)}},data:function(){return{tableHeight:document.body.clientHeight-230}},methods:{selectedRow:function(t){this.$emit("getClickedType",t)},handleInfo:function(t){this.$emit("getdataob",t)},showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return t.row._show=e,e?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(t){var e=this.formatData[t];e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e.childList&&e.childList.length>0}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",t._b({attrs:{data:t.formatData,"row-style":t.showRow,height:t.tableHeight},on:{"selection-change":t.selectedRow}},"el-table",t.$attrs,!1),[a("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),0===t.columns.length?a("el-table-column",{attrs:{width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row._level,function(t){return a("span",{key:t,staticClass:"ms-tree-space"})}),t._v(" "),t.iconShow(0,e.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(a){t.toggleExpanded(e.$index)}}},[e.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):t._e(),t._v("\n      "+t._s(e.$index)+"\n    ")]}}])}):t._l(t.columns,function(e,i){return a("el-table-column",{key:e.value,attrs:{label:e.text,width:e.width},scopedSlots:t._u([{key:"default",fn:function(n){return[t._l(n.row._level,function(e){return 0===i?a("span",{key:e,staticClass:"ms-tree-space"}):t._e()}),t._v(" "),t.iconShow(i,n.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(e){t.toggleExpanded(n.$index)}}},[n.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):t._e(),t._v(" "),"name"===e.value?a("span",{staticClass:"link-type",on:{click:function(e){t.handleInfo(n.row)}}},[t._v(t._s(n.row[e.value]))]):"type"===e.value?a("span",[t._v(t._s(t._f("isType")(n.row[e.value])))]):a("span",[t._v(t._s(n.row[e.value]))])]}}])})}),t._v(" "),t._t("default")],2)},staticRenderFns:[]};var h=a("VU/8")(m,f,!1,function(t){a("aokj"),a("iNUo")},"data-v-49a33177",null).exports,v=a("oQWa"),g=a("7t+N"),y=a.n(g),b=a("ZjsX"),w=sessionStorage.getItem("token"),_=[{value:1,label:"公司"},{value:2,label:"单位"},{value:3,label:"部门"}],x=_.reduce(function(t,e){return t[e.value]=e.label,t},{}),k={name:"complexTable",directives:{waves:s.a},components:{treeTable:h,treeTableForTc:v.a},data:function(){return{deptreeList:!1,listData:[],typeList:_,columna:[{text:"部门名称",value:"name",width:250}],columns:[{text:"名称",value:"name",width:230},{text:"创建人",value:"createBy",width:130},{text:"创建时间",value:"createAt",width:170},{text:"创建类型",value:"type",width:130},{text:"备注",value:"remark",width:160}],data:[],datas:[],currentPage:1,pageSize:15,total:null,isUpdate:!0,setDisabled:!1,tableKey:0,list:null,listLoading:!0,departmentDatas:[],companyList:[],showReviewer:!1,temp:{id:void 0,orgId:"",name:"",remark:"",type:"",sorting:"",code:"",createBy:"",createTime:"",upname:"",pcode:""},dialogFormVisible:!1,dialogStatus:"",textMap:{create:"添加部门",update:"编辑部门",info:"部门详细"},dialogPvVisible:!1,pvData:[],rules:{name:[{required:!0,message:"请输入部门名称"}],type:[{required:!0,message:"请选择类型"}],sorting:[{message:"请输入数字序号",validator:function(t,e,a){""!==e?!1===/^\d+$/.test(e)?a(new Error("请输入数字序号")):a():a(new Error("请输入数字序号"))}}]},downloadLoading:!1,authorityCodePage:""}},filters:{statusFilter:function(t){return{published:"success",draft:"info",deleted:"danger"}[t]},typeFilter:function(t){return x[t]}},created:function(){var t=sessionStorage.getItem("index"),e=Object(b.b)(t);this.authorityCodebutton=e[0],this.authorityCodePage=e[1],this.getCompanyList()},methods:{opender:function(){this.deptreeList=!0},closeup:function(){this.deptreeList=!1,this.getCompanyList()},changeGetdata:function(t){this.listData=t},seeDetail:function(t){this.dialogStatus="info",this.isUpdate=!1,this.setDisabled=!0,this.handleUpdate(t)},chooseDer:function(){0!==this.listData.length&&1===this.listData.length?(this.temp.upname=this.listData[0].name,this.temp.pcode=this.listData[0].code,this.deptreeList=!1):0===this.listData.length?(this.deptreeList=!1,this.temp.pcode="0"):this.$notify({title:"系统提示",message:"请选择一条数据进行添加！",type:"warning",duration:2e3})},changeClickedType:function(t){this.listData=t},getList:function(t,e){this.listLoading=!0;var a=this,i={page:t,size:e};Object(b.d)("/v1/depts/",{token:w,authorityCode:a.authorityCodePage},i,function(t){200===t.data.status?(a.total=t.data.data.total,a.departmentDatas=t.data.data.list,setTimeout(function(){a.listLoading=!1},1500)):a.$notify({title:"系统提示",message:t.data.msg,type:"error",duration:2e3})},function(t){console.log(t),a.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})},selectRow:function(t){this.selectlistRow=t},handleCreate:function(){var t=this;this.resetTemp(),this.isUpdate=!0,this.setDisabled=!1,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()}),setTimeout(function(){t.temp.name="",t.temp.orgId="",t.temp.remark=""},300)},handleUpdate:function(t){this.resetTemp();var e=this;e.dialogFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate()}),Object(b.d)("/v1/depts/"+t.code,{token:w,authorityCode:1},{},function(t){if(200===t.data.status){var a=t.data.data;e.temp.name=a.name,e.temp.upname=a.pname,e.temp.code=a.code,e.temp.sorting=a.sorting,e.temp.remark=a.remark,e.temp.type=a.type,e.temp.pcode=a.pcode}else e.$notify({title:"系统提示",message:"查看详情失败！",type:"warning",duration:2e3})})},edit:function(){this.setDisabled=!1,this.isUpdate=!0,this.dialogStatus="update",this.listData&&this.listData|0!==this.listData.length&&1===this.listData.length?this.handleUpdate(this.listData[0]):this.$notify({title:"系统提示",message:"请选择一条数据进行编辑！",type:"warning",duration:2e3})},delData:function(){var t=this;if(t.listData){for(var e=[],a=0;a<t.listData.length;a++)e.push(t.listData[a].code);0!==t.listData.length?t.$confirm("确认要删除么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){y.a.ajax({url:b.a+"/v1/depts",method:"delete",headers:{token:w,authorityCode:1,"Content-Type":"application/json; charset=utf-8"},dataType:"json",data:n()({codes:e}),success:function(e){200===e.status&&t.getCompanyList()}})}).catch(function(){t.$notify({title:"系统提示",message:"已取消删除",type:"info",duration:2e3})}):t.$notify({title:"系统提示",message:"请选择一条或多条数据进行删除操作！",type:"warning",duration:2e3})}else t.$notify({title:"系统提示",message:"请选择一条或多条数据进行删除操作！",type:"warning",duration:2e3})},addDepartmentmanagement:function(){var t=this;void 0===this.temp.pcode&&(this.temp.pcode="0");var e={name:t.temp.name,pcode:t.temp.pcode,sorting:t.temp.sorting,type:t.temp.type,remark:t.temp.remark};this.$refs.dataForm.validate(function(a){a&&Object(b.f)("/v1/depts/",{token:w,authorityCode:1},e,function(e){200===e.data.status&&(t.dialogFormVisible=!1,t.$notify({title:"系统提示",message:"创建成功",type:"success",duration:2e3}),t.getCompanyList())},function(e){console.log(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})})},updateData:function(){var t=this,e={name:t.temp.name,code:t.temp.code,remark:t.temp.remark,sorting:t.temp.sorting,type:t.temp.type,pcode:t.temp.pcode};t.$refs.dataForm.validate(function(a){a&&Object(b.g)("/v1/depts/",{token:w,authorityCode:1},e,function(e){200===e.data.status&&(t.dialogFormVisible=!1,t.$notify({title:"系统提示",message:"更新成功",type:"success",duration:2e3}),t.getCompanyList())},function(e){console.log(e),t.$notify({title:"系统提示",message:"更新失败",type:"fail",duration:2e3})})})},resetTemp:function(){this.temp={id:void 0,orgId:"",name:"",remark:"",type:"",sorting:"",code:"",createBy:"",createTime:"",upname:""}},getCompanyList:function(){var t=this;Object(b.d)("/v1/depts/tree",{token:w,authorityCode:1},{},function(e){if(200===e.data.status){var a=e.data.data;t.data=a,t.datas=a}else t.$notify({title:"系统提示",message:e.data.msg,type:"error",duration:3e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},t._l(t.authorityCodebutton,function(e){return a("div",{key:e.a,staticClass:"btn_right"},["添加"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.handleCreate}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"编辑"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(e){t.edit()}}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"删除"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(e){e.preventDefault(),t.delData()}}},[t._v(t._s(e.name))]):t._e()],1)})),t._v(" "),a("tree-table",{attrs:{data:t.data,columns:t.columns,border:""},on:{getClickedType:t.changeClickedType,getdataob:t.seeDetail}}),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"480px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"15px"},attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"120px",disabled:t.setDisabled}},[a("el-form-item",{attrs:{label:"部门名称",required:"",prop:"name"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name",e)},expression:"temp.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"上级公司"}},[a("el-input",{staticStyle:{width:"250px"},on:{focus:t.opender},model:{value:t.temp.upname,callback:function(e){t.$set(t.temp,"upname",e)},expression:"temp.upname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型",required:"",prop:"type"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},model:{value:t.temp.type,callback:function(e){t.$set(t.temp,"type",e)},expression:"temp.type"}},t._l(t.typeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"序号",required:"",prop:"sorting"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.sorting,callback:function(e){t.$set(t.temp,"sorting",e)},expression:"temp.sorting"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"textarea"},model:{value:t.temp.remark,callback:function(e){t.$set(t.temp,"remark",e)},expression:"temp.remark"}})],1)],1),t._v(" "),t.isUpdate?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.addDepartmentmanagement}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1):t._e()],1),t._v(" "),a("el-dialog",{staticStyle:{"margin-left":"100px"},attrs:{visible:t.deptreeList,width:"480px"},on:{"update:visible":function(e){t.deptreeList=e}}},[a("treeTableForTc",{attrs:{data:t.datas,columns:t.columna,border:""},on:{getClickedType:t.changeGetdata}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeup}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.chooseDer}},[t._v(t._s(t.$t("table.confirm")))])],1)],1)],1)},staticRenderFns:[]};var D=a("VU/8")(k,C,!1,function(t){a("UF1S")},null,null);e.default=D.exports}});