webpackJsonp([7],{"3d7s":function(t,e,a){var i=a("WeRj");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("6f8b72ce",i,!0)},ILso:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.btn_right{\n  float: right;\n}\n",""])},WeRj:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n.ms-tree-space[data-v-c8953044] {\n  position: relative;\n  top: 1px;\n  display: inline-block;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1;\n  width: 18px;\n  height: 14px;\n}\n.ms-tree-space[data-v-c8953044]::before {\n    content: "";\n}\n.processContainer[data-v-c8953044] {\n  width: 100%;\n  height: 100%;\n}\ntable td[data-v-c8953044] {\n  line-height: 26px;\n}\n.tree-ctrl[data-v-c8953044] {\n  position: relative;\n  cursor: pointer;\n  color: #2196F3;\n  margin-left: -18px;\n}\n',""])},msY9:function(t,e,a){var i=a("nKst");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("1368e395",i,!0)},nKst:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n@keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n@-webkit-keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n",""])},poG2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),s=a("cAgV"),l=a("dXij"),o=a.n(l),r=a("c/Tr"),c=a.n(r),d=a("/5sW");function u(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[];return c()(t).forEach(function(t){void 0===t._expanded&&d.default.set(t,"_expanded",e);var s=1;if(void 0!==i&&null!==i&&(s=i+1),d.default.set(t,"_level",s),a&&d.default.set(t,"parent",a),n.push(t),t.childList&&t.childList.length>0){var l=u(t.childList,e,t,s);n=n.concat(l)}}),n}var p=[{value:1,label:"公司"},{value:2,label:"单位"},{value:3,label:"部门"}].reduce(function(t,e){return t[e.value]=e.label,t},{}),m={name:"TreeTableForJurisdiction",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},filters:{isType:function(t){return p[t]}},computed:{formatData:function(){var t=void 0;t=Array.isArray(this.data)?this.data:[this.data];var e=this.evalFunc||u,a=this.evalArgs?o()([t,this.expandAll],this.evalArgs):[t,this.expandAll];return e.apply(null,a)}},data:function(){return{tableHeight:document.body.clientHeight-265}},methods:{selectedRow:function(t){this.$emit("getClickedType",t)},handleInfo:function(t){this.$emit("getdataob",t)},showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return t.row._show=e,e?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(t){var e=this.formatData[t];e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e.childList&&e.childList.length>0}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",t._b({attrs:{data:t.formatData,"row-style":t.showRow,height:t.tableHeight},on:{"selection-change":t.selectedRow}},"el-table",t.$attrs,!1),[a("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),0===t.columns.length?a("el-table-column",{attrs:{width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row._level,function(t){return a("span",{key:t,staticClass:"ms-tree-space"})}),t._v(" "),t.iconShow(0,e.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(a){t.toggleExpanded(e.$index)}}},[e.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):t._e(),t._v("\n      "+t._s(e.$index)+"\n    ")]}}])}):t._l(t.columns,function(e,i){return a("el-table-column",{key:e.value,attrs:{label:e.text,width:e.width},scopedSlots:t._u([{key:"default",fn:function(n){return[t._l(n.row._level,function(e){return 0===i?a("span",{key:e,staticClass:"ms-tree-space"}):t._e()}),t._v(" "),t.iconShow(i,n.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(e){t.toggleExpanded(n.$index)}}},[n.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):t._e(),t._v(" "),"name"===e.value?a("span",{staticClass:"link-type",on:{click:function(e){t.handleInfo(n.row)}}},[t._v(t._s(n.row[e.value]))]):a("span",[t._v(t._s(n.row[e.value]))])]}}])})}),t._v(" "),t._t("default")],2)},staticRenderFns:[]};var f=a("VU/8")(m,h,!1,function(t){a("msY9"),a("3d7s")},"data-v-c8953044",null).exports,v=a("oQWa"),g=a("7t+N"),y=a.n(g),b=a("ZjsX"),_=sessionStorage.getItem("token"),w=[{value:1,label:"菜单"},{value:2,label:"按钮"}].reduce(function(t,e){return t[e.value]=e.label,t},{}),x={name:"complexTable",directives:{waves:s.a},components:{treeTable:f,treeTableForTc:v.a},data:function(){return{istianjia:!1,data:[],datas:[],setDisabled:!1,listData:[],deptreeList:!1,columna:[{text:"权限名称",value:"name",width:350}],columns:[{text:"权限名称",value:"name",width:290},{text:"创建时间",value:"createAt",width:170},{text:"类型",value:"type",width:130},{text:"图标路径",value:"icon",width:270},{text:"菜单路径",value:"url",width:290},{text:"备注",value:"remark",width:230}],typeList:[{value:1,label:"菜单"},{value:2,label:"按钮"}],data2:[],currentPage:1,pageSize:15,tableKey:0,isUpdate:!0,list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"},props:{label:"name",children:"zones"},authorityCodebutton:[],authorityCodePage:"",temp:{id:void 0,importance:1,remark:"",timestamp:new Date,title:"",type:"",status:"",status1:"",pcode:"0",name:"",rolename:"",icon:"",url:"",sorting:"",code:"0"},buttonlist:[],dialogFormVisible:!1,dialogStatus:"",textMap:{create:"添加权限",update:"编辑权限",info:"权限详细"},rules:{rolename:[{required:!0,message:"请输入权限名称"}],name:[{required:!0,message:"请选择上级公司"}],type:[{required:!0,message:"请选择类型"}],sorting:[{validator:function(t,e,a){""!==e?!1===/^[0-9]{1,5}$/.test(e)?a(new Error("请输入小于5位的数字序号")):a():a("请输入序号")}}],icon:[{required:!0,message:"请输入图标路径"}],url:[{required:!0,message:"请输入菜单路径"}],remark:[{required:!0,message:"请填写备注"}]}}},filters:{statusFilter:function(t){return{published:"success",draft:"info",deleted:"danger"}[t]},typeFilter:function(t){return w[t]}},mounted:function(){this.authorityCodebutton=this.buttonlist[0],this.authorityCodePage=this.buttonlist[1],console.log(this.buttonlist,"123456")},created:function(){var t=sessionStorage.getItem("index");this.buttonlist=Object(b.b)(t),this.getJurList()},methods:{opender:function(){this.deptreeList=!0},closeup:function(){this.deptreeList=!1,this.getJurList()},chooseDer:function(){0!==this.listData.length&&1===this.listData.length?(this.temp.name=this.listData[0].name,this.temp.code=this.listData[0].code,this.deptreeList=!1):0===this.listData.length?(this.deptreeList=!1,this.temp.code="0"):this.$notify({title:"系统提示",message:"请选择一条数据进行添加！",type:"warning",duration:2e3})},seeDetail:function(t){console.log(t),this.dialogStatus="info",this.isUpdate=!1,this.setDisabled=!0,this.handleUpdate(t)},changeGetdata:function(t){this.listData=t,console.log(this.listData,"111")},getJurList:function(){var t=this;Object(b.d)("/v1/acls/tree",{token:_,authorityCode:1},{},function(e){if(console.log(e),200===e.data.status){for(var a=e.data.data,i=0;i<a.length;i++){1===a[i].type?a[i].type="菜单":2===a[i].type&&(a[i].type="按钮");for(var n=0;n<a[i].childList.length;n++){1===a[i].childList[n].type?a[i].childList[n].type="菜单":2===a[i].childList[n].type&&(a[i].childList[n].type="按钮");for(var s=0;s<a[i].childList[n].childList.length;s++)1===a[i].childList[n].childList[s].type?a[i].childList[n].childList[s].type="菜单":2===a[i].childList[n].childList[s].type&&(a[i].childList[n].childList[s].type="按钮")}}t.data=a,t.datas=a,console.log(t.data)}else t.$notify({title:"系统提示",message:e.data.msg,type:"error",duration:3e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})},delData:function(){var t=this;if(t.listData){for(var e=[],a=0;a<t.listData.length;a++)e.push(t.listData[a].code);0!==t.listData.length?t.$confirm("确认要删除么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){y.a.ajax({url:b.a+"/v1/acls",method:"delete",headers:{token:_,authorityCode:1,"Content-Type":"application/json; charset=utf-8"},dataType:"json",data:n()({codes:e}),success:function(e){200===e.status&&t.getJurList()}})}).catch(function(){t.$notify({title:"系统提示",message:"已取消删除",type:"info",duration:2e3})}):t.$notify({title:"系统提示",message:"请选择一条或多条数据进行删除操作！",type:"warning",duration:2e3})}else t.$notify({title:"系统提示",message:"请选择一条或多条数据进行删除操作！",type:"warning",duration:2e3})},edit:function(){this.setDisabled=!1,this.isUpdate=!0,this.dialogStatus="update",this.listData|0!==this.listData.length&&1===this.listData.length?this.handleUpdate(this.listData[0]):this.$notify({title:"系统提示",message:"请选择一条或多条数据进行操作！",type:"warning",duration:2e3})},resetTemp:function(){this.temp={id:void 0,importance:1,remark:"",timestamp:new Date,title:"",type:"",status:"",status1:"",pcode:"0",name:"",rolename:"",icon:"",url:"",sorting:"",code:""}},handleCreate:function(){var t=this;this.resetTemp(),this.setDisabled=!1,this.isUpdate=!0,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},createRole:function(){var t=this;""===this.temp.code&&(this.temp.code="0");var e={name:this.temp.rolename,pcode:this.temp.code,type:this.temp.type,sorting:this.temp.sorting,icon:this.temp.icon,url:this.temp.url,remark:this.temp.remark},a=this;a.$refs.dataForm.validate(function(i){i&&(t.istianjia=!0,Object(b.f)("/v1/acls",{token:_,authorityCode:1},e,function(t){200===t.data.status&&(a.dialogFormVisible=!1,a.istianjia=!1,a.$notify({title:"系统提示",message:"创建成功",type:"success",duration:2e3}),a.getJurList())},function(t){a.istianjia=!1,console.log(t),a.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})}))})},handleUpdate:function(t){var e=this;e.dialogFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate()}),Object(b.d)("/v1/acls/"+t.code,{token:_,authorityCode:1},{},function(t){var a=t.data.data;e.temp.rolename=a.name,e.temp.name=a.pname,e.temp.type=a.type,e.temp.sorting=a.sorting,e.temp.icon=a.icon,e.temp.url=a.url,e.temp.remark=a.remark,e.temp.code=a.code,e.temp.pcode=a.pcode},function(t){console.log(t),e.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})},updateData:function(){var t=this,e={code:t.temp.code,name:t.temp.rolename,pcode:t.temp.pcode,type:t.temp.type,sorting:t.temp.sorting,icon:t.temp.icon,url:t.temp.url,remark:t.temp.remark};t.$refs.dataForm.validate(function(a){a&&Object(b.g)("/v1/acls",{token:_,authorityCode:1},e,function(e){t.dialogFormVisible=!1,200===e.data.status?(t.$notify({title:"系统提示",message:"更新成功",type:"success",duration:2e3}),t.getJurList()):t.$notify({title:"系统提示",message:"更新失败",type:"error",duration:2e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})})},getList:function(t,e){var a=this;this.listLoading=!0;var i=this,n={name:i.listQuery.title,page:t,size:e};Object(b.d)("/v1/acls",{token:_,authorityCode:1},n,function(t){i.data=t.data.data.list}),setTimeout(function(){a.listLoading=!1},1500)}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},t._l(t.authorityCodebutton,function(e){return a("div",{key:e.a,staticClass:"btn_right"},["添加"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.handleCreate}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"编辑"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(e){t.edit()}}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"删除"===e.name?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(e){e.preventDefault(),t.delData()}}},[t._v(t._s(e.name))]):t._e()],1)})),t._v(" "),a("tree-table",{attrs:{data:t.data,columns:t.columns,border:""},on:{getClickedType:t.changeGetdata,getdataob:t.seeDetail}}),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"480px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"15px"},attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"120px",disabled:t.setDisabled}},[a("el-form-item",{attrs:{label:"权限名称",required:"",prop:"rolename"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.rolename,callback:function(e){t.$set(t.temp,"rolename",e)},expression:"temp.rolename"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"上级权限"}},[a("el-input",{staticStyle:{width:"250px"},on:{focus:t.opender},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name",e)},expression:"temp.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"添加类型",required:"",prop:"type"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{placeholder:"请选择类型"},model:{value:t.temp.type,callback:function(e){t.$set(t.temp,"type",e)},expression:"temp.type"}},t._l(t.typeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",required:"",prop:"sorting"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.sorting,callback:function(e){t.$set(t.temp,"sorting",e)},expression:"temp.sorting"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图标路径"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.icon,callback:function(e){t.$set(t.temp,"icon",e)},expression:"temp.icon"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"菜单路径"}},[a("el-input",{staticStyle:{width:"250px"},model:{value:t.temp.url,callback:function(e){t.$set(t.temp,"url",e)},expression:"temp.url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"textarea"},model:{value:t.temp.remark,callback:function(e){t.$set(t.temp,"remark",e)},expression:"temp.remark"}})],1)],1),t._v(" "),t.isUpdate?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary",loading:t.istianjia},on:{click:t.createRole}},[t._v(t._s(t.$t("table.confirm")))]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v(t._s(t.$t("table.confirm")))])],1):t._e()],1),t._v(" "),a("el-dialog",{staticStyle:{"margin-left":"100px"},attrs:{visible:t.deptreeList,width:"480px"},on:{"update:visible":function(e){t.deptreeList=e}}},[a("treeTableForTc",{attrs:{data:t.datas,columns:t.columna,border:""},on:{getClickedType:t.changeGetdata}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeup}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.chooseDer}},[t._v(t._s(t.$t("table.confirm")))])],1)],1)],1)},staticRenderFns:[]};var L=a("VU/8")(x,k,!1,function(t){a("vK5J")},null,null);e.default=L.exports},vK5J:function(t,e,a){var i=a("ILso");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("50e64ad4",i,!0)}});