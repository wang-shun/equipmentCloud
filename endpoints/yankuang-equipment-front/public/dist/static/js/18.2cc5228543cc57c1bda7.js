webpackJsonp([18],{"2KB3":function(e,t,i){var a=i("r3PH");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("717acc44",a,!0)},Fx1r:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("/5sW"),s=i("cAgV"),l=i("ZjsX"),n=i("lbHh"),o=i.n(n).a.get("token"),r=[{value:"01",label:"在用"},{value:"02",label:"备用"},{value:"03",label:"闲置"},{value:"04",label:"待修"},{value:"05",label:"待报废"},{value:"06",label:"报废"}],u=[{value:"01",label:"使用地点"},{value:"02",label:"储备库"},{value:"03",label:"租赁库"},{value:"04",label:"本部"}],c=[{value:"1",label:"设备管理中心"}],d=[{value:1,label:"是"},{value:2,label:"否"}],p=[{value:1,label:"是"},{value:2,label:"否"}],f=JSON.parse(sessionStorage.getItem("positonList")),m=r.reduce(function(e,t){return e[t.value]=t.label,e},{}),g=u.reduce(function(e,t){return e[t.value]=t.label,e},{}),v=c.reduce(function(e,t){return e[t.value]=t.label,e},{}),h=d.reduce(function(e,t){return e[t.value]=t.label,e},{}),y=p.reduce(function(e,t){return e[t.value]=t.label,e},{}),b=f.reduce(function(e,t){return e[t.id]=t.name,e}),_={name:"complexTable",directives:{waves:s.a},data:function(){return{istianjia:!1,szposition:[],tableHeight:document.body.clientHeight-250,currentPage:1,pageSize:15,codeShowYN:!1,isUpdate:!0,setDisabled:!1,tableKey:0,list:null,total:null,listLoading:!0,listQuery:{code:null,name:null,type:null,org:null,position:null},count:1,specificationModelTable:[],stateList:r,typeList:u,companyList:c,positionList:[],isuseList:d,isrfidList:p,temp:{id:void 0,name:"",state:"",type:"",org:"",position:"",isuse:"",isrfid:""},dialogFormVisible:!1,dialogPvVisible:!1,dialogStatus:"",textMap:{update:"编辑设备功能位置",create:"添加设备功能位置",info:"设备功能位置详细"},rules:{name:[{required:!0,message:"请输入功能位置名称"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],position:[{required:!0,message:"请选择所在位置",trigger:"change"}],isuse:[{required:!0,message:"请选择是否可用",trigger:"change"}],isrfid:[{required:!0,message:"请选择是否开启rfid",trigger:"change"}],org:[{required:!0,message:"请选择所属公司",trigger:"change"}]},buttonlist:[],authorityCodebutton:[],authorityCodePage:""}},filters:{stateFilter:function(e){return m[e]},typeFilter:function(e){return g[e]},companyFilter:function(e){return v[e]},isuseFilter:function(e){return h[e]},isrfidFilter:function(e){return y[e]},isposition:function(e){return b[e]}},created:function(){var e=sessionStorage.getItem("index");this.buttonlist=Object(l.b)(e),this.authorityCodebutton=this.buttonlist[0],this.authorityCodePage=this.buttonlist[1],this.getList(this.currentPage,this.pageSize),this.getLocationList()},methods:{search:function(){this.getList(this.currentPage,this.pageSize)},reset:function(){this.listQuery=[],this.getList(this.currentPage,this.pageSize)},getList:function(e,t){this.listLoading=!0;var i=this,s={code:this.listQuery.code,name:this.listQuery.name,type:this.listQuery.type,org:this.listQuery.org,position:this.listQuery.position,pageNum:e,pageSize:t};Object(l.d)("/v1/sbposition/list",{token:o,authorityCode:1},s,function(e){i.listLoading=!1;var t=[];if("200"===e.data.meta.code){i.total=e.data.data.total;for(var a=e.data.data.list,s=0;s<a.length;s++){var l={};l.id=a[s].id,l.code=a[s].code,l.name=a[s].name,l.state=a[s].state,l.type=a[s].type,l.isuse=a[s].isuse,l.isrfid=a[s].isrfid,l.org=a[s].org,l.position=a[s].position,l.positionName=a[s].positionName,t[s]=l}i.specificationModelTable=t}else"201"===e.data.meta.code?(i.listLoading=!1,i.specificationModelTable=[],i.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:3e3})):i.$notify({title:"系统提示",message:e.data.meta.message,type:"error",duration:2e3})},function(e){i.listLoading=!1,a.default.use(e),i.$notify({title:"系统提示",message:"系统错误",type:"error",duration:3e3})})},handleCreate:function(){var e=this;this.codeShowYN=!1,this.isUpdate=!0,this.setDisabled=!1,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()}),setTimeout(function(){e.$refs.dataForm.resetFields(),e.temp.code=""},300)},addPosition:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){e.istianjia=!0;var i=e;Object(l.f)("/v1/sbposition/create",{token:o,authorityCode:1},e.temp,function(e){"200"===e.data.meta.code?(i.dialogFormVisible=!1,i.getList(i.currentPage,i.pageSize),i.istianjia=!1,i.$notify({title:"系统提示",message:"功能位置添加成功",type:"success",duration:3e3})):(i.istianjia=!1,i.$notify({title:"系统提示",message:"功能位置添加失败",type:"error",duration:3e3}))},function(e){i.listLoading=!1,i.istianjia=!1,a.default.use(e),i.$notify({title:"系统提示",message:"系统错误",type:"error",duration:3e3})})}})},getLocationList:function(e){var t=this;Object(l.d)("/v1/elplan",{token:o,authorityCode:1},{page:1,size:100,pCode:"",type:3},function(e){var i=[];if(200===e.data.status){for(var a=e.data.data.list,s=0;s<a.length;s++){var l={};l.id=a[s].id,l.name=a[s].name,i[s]=l}t.positionList=i,t.szposition=t.positionList}else t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:3e3})},function(e){t.listLoading=!1,a.default.use(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:3e3})})},handleSizeChange:function(e){this.getList(this.currentPage,e)},handleCurrentChange:function(e){this.getList(e,this.pageSize)},handleUpdate:function(e){var t=this;this.codeShowYN=!0,this.isUpdate=!0,this.setDisabled=!1,this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleInfo:function(e){this.dialogStatus="info",this.dialogFormVisible=!0,this.codeShowYN=!0,this.isUpdate=!1,this.setDisabled=!0,this.getSpModalInfo(e.id)},getSpModalInfo:function(e){var t=this;Object(l.d)("/v1/sbposition/find/"+e,{token:o,authorityCode:1},{},function(e){if("200"===e.data.meta.code){var i=e.data.data;t.temp.id=i.id,t.temp.code=i.code,t.temp.name=i.name,t.temp.state=i.state,t.temp.type=i.type,t.temp.org=i.org,t.temp.position=parseInt(i.position),t.temp.isuse=i.isuse,t.temp.isrfid=i.isrfid}else t.$notify({title:"系统提示",message:"请求失败",type:"error",duration:3e3})},function(e){t.listLoading=!1,a.default.use(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:3e3})})},updateData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var i=e;Object(l.g)("/v1/sbposition/update",{token:o,authorityCode:1},e.temp,function(e){"200"===e.data.meta.code?(i.dialogFormVisible=!1,i.getList(i.currentPage,i.pageSize),i.$notify({title:"系统提示",message:"更新成功",type:"success",duration:2e3})):i.$notify({title:"系统提示",message:e.data.meta.message,type:"error",duration:2e3})},function(e){i.listLoading=!1,a.default.use(e),i.$notify({title:"系统提示",message:"系统错误",type:"error",duration:3e3})})}})},selectRow:function(e){this.selectlistRow=e},edit:function(){this.selectlistRow&&0!==this.selectlistRow.length&&1===this.selectlistRow.length?(this.handleUpdate(),this.getSpModalInfo(this.selectlistRow[0].id)):this.$notify({title:"系统提示",message:"请选择一条数据进行编辑！",type:"warning",duration:2e3})},delData:function(){var e=this;this.selectlistRow&&0!==this.selectlistRow.length?this.$confirm("确认要删除么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e,i="",s=0;s<t.selectlistRow.length;s++)i+=t.selectlistRow[s].id+",";i=i.substring(0,i.length-1),Object(l.c)("/v1/sbposition/deletes/"+i,{token:o,authorityCode:1},{},function(e){t.getList(t.currentPage,t.pageSize),t.$notify({title:"系统提示",message:"删除成功！",type:"success",duration:2e3})},function(e){t.listLoading=!1,a.default.use(e),t.$notify({title:"系统提示",message:"请求失败",type:"error",duration:3e3})})}).catch(function(){e.$notify({title:"系统提示",message:"已取消删除",type:"info",duration:2e3})}):this.$notify({title:"系统提示",message:"请选择一条数据进行删除操作",type:"warning",duration:2e3})}}},w={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container",staticStyle:{}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"编号"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.search(t)}},model:{value:e.listQuery.code,callback:function(t){e.$set(e.listQuery,"code",t)},expression:"listQuery.code"}}),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.search(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{filterable:"",placeholder:"类型"},model:{value:e.listQuery.type,callback:function(t){e.$set(e.listQuery,"type",t)},expression:"listQuery.type"}},e._l(e.typeList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{filterable:"",placeholder:"所属单位"},model:{value:e.listQuery.org,callback:function(t){e.$set(e.listQuery,"org",t)},expression:"listQuery.org"}},e._l(e.companyList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{filterable:"",placeholder:"所在位置"},model:{value:e.listQuery.position,callback:function(t){e.$set(e.listQuery,"position",t)},expression:"listQuery.position"}},e._l(e.positionList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),e._l(e.authorityCodebutton,function(t){return i("div",{key:t.a,staticClass:"btn_right"},["添加"===t.name?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"small"},on:{click:e.handleCreate}},[e._v("添加")]):e._e(),e._v(" "),"编辑"===t.name?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(t){e.edit()}}},[e._v("编辑")]):e._e(),e._v(" "),"删除"===t.name?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(t){t.preventDefault(),e.delData()}}},[e._v("删除")]):e._e()],1)})],2),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,ref:"moviesTable",staticStyle:{width:"100%"},attrs:{data:e.specificationModelTable,border:"",fit:"","highlight-current-row":"",height:e.tableHeight},on:{"selection-change":e.selectRow}},[i("el-table-column",{attrs:{type:"selection",width:"35px"}}),e._v(" "),i("el-table-column",{attrs:{width:"110px",align:"center",label:"编号",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.code))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"280px",align:"center",label:"功能位置名称",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",attrs:{align:"center"},on:{click:function(i){e.handleInfo(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100px",align:"center",label:"默认状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("stateFilter")(t.row.state)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100px",align:"center",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("typeFilter")(t.row.type)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100px",align:"center",label:"是否可用"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("isuseFilter")(t.row.isuse)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100px",align:"center",label:"是否开启rfid"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("isrfidFilter")(t.row.isrfid)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"150px",align:"center",label:"所属单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.org))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"150px",align:"center",label:"所在位置"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{directives:[{name:"show",rawName:"v-show",value:e.show=!1,expression:"show = false"}]},[e._v(e._s(t.row.position))]),e._v(" "),i("span",[e._v(e._s(t.row.positionName))])]}}])})],1),e._v(" "),i("div",{staticClass:"block"},[i("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[15,30,45,60,75,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,width:"800px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"dataForm",attrs:{rules:e.rules,"status-icon":"",model:e.temp,"label-position":"right","label-width":"120px",disabled:e.setDisabled}},[i("el-row",[i("el-col",{attrs:{span:12}},[e.codeShowYN?i("el-form-item",{attrs:{label:"编号"}},[i("span",[e._v(e._s(e.temp.code))])]):e._e()],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"功能位置名称",required:"",prop:"name"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"250px"},model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1)],1)],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"状态",prop:"state"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:e.temp.state,callback:function(t){e.$set(e.temp,"state",t)},expression:"temp.state"}},e._l(e.stateList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"类型",required:"",prop:"type"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:e.temp.type,callback:function(t){e.$set(e.temp,"type",t)},expression:"temp.type"}},e._l(e.typeList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"所属单位",required:"",prop:"org"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:e.temp.org,callback:function(t){e.$set(e.temp,"org",t)},expression:"temp.org"}},e._l(e.companyList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"所在位置",required:"",prop:"position"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},on:{change:function(t){e.getLocationList(t)}},model:{value:e.temp.position,callback:function(t){e.$set(e.temp,"position",t)},expression:"temp.position"}},e._l(e.positionList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"是否可用",required:"",prop:"isuse"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:e.temp.isuse,callback:function(t){e.$set(e.temp,"isuse",t)},expression:"temp.isuse"}},e._l(e.isuseList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"是否开启rfid",required:"",prop:"isrfid"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:e.temp.isrfid,callback:function(t){e.$set(e.temp,"isrfid",t)},expression:"temp.isrfid"}},e._l(e.isrfidList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),e.isUpdate?i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary",loading:e.istianjia},on:{click:e.addPosition}},[e._v("确定")]):i("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("确定")])],1):e._e()],1)],1)},staticRenderFns:[]};var k=i("VU/8")(_,w,!1,function(e){i("2KB3")},null,null);t.default=k.exports},r3PH:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"\n.btn_right{\n  float: right;\n}\n.block {\n  margin-top: 10px;\n}\n.el-dialog__body {\n  padding: 6px 20px !important;\n}\n",""])}});