webpackJsonp([46],{rLwQ:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("mvHQ"),s=t.n(a),i=t("ZjsX"),r=t("lbHh"),o=t.n(r),l=t("lDdF"),u=t.n(l),p=t("uXZL"),c=t.n(p),m=o.a.get("token"),d={name:"abnormalLosses",data:function(){return{style:{borderTop:"none",borderLeft:"none",borderRight:"none"},applyCompanyList:[],deptCode:{},listQuery:{date:this.formatDate(),useDepartment:""},sign:{createExcelName:"",statusName:"",sureName:""},tableData3:[{name:"合计",sum:0,notShow:!0},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],tableData:[{name1:"制表：",name2:"审核：",name3:"矿方确认签字："}]}},methods:{formatDate:function(){var n=new Date,e=(n.getMonth()+1).toString();return n.getFullYear()+"-"+e},handleEdit:function(n,e){var t=0;this.tableData3.forEach(function(n,e){0===e||isNaN(n.sum)||(t+=parseFloat(n.sum))}),this.tableData3[0].sum=t},getDeptList:function(){var n=this;this.applyCompanyList=[],Object(i.d)("/v1/elplan?page=1&size=100&type=21",{token:m,authorityCode:1},{},function(e){200===e.data.status?e.data.data.list.forEach(function(e,t){var a={};a.deptCode=e.code,a.name=e.name,a.id=e.id,n.applyCompanyList.push(a)}):n.$notify({title:"错误",message:e.data.meta.message,type:"error",duration:3e3})})},search:function(){if(""===this.listQuery.useDepartment||""===this.listQuery.date)this.$notify({title:"系统提示",message:"请完整选择搜索条件！",type:"warning",duration:3e3});else{var n=this,e=this.listQuery.date.substring(0,4),t=parseInt(this.listQuery.date.substring(5,7))+"",a={},r={};r.useYear=e,r.useMonth=t,r.useDeptCode=this.deptCode.deptCode,r.useDeptName=this.deptCode.name,Object(i.d)("/v1/eloss?page=1&size=1000&jsonString="+s()(r),{token:m,authorityCode:1},{},function(e){if(200===e.data.status){var t=e.data.data.list;t&&0!==t.length?(n.tableData3=t,n.sign.createExcelName=t[0].createExcelName,n.sign.statusName=t[0].statusName,n.sign.sureName=t[0].sureName,a.sum=t[0].feeSum||0,a.name="合计",a.notShow=!0,n.tableData3.unshift(a)):(n.tableData3=[],n.sign.createExcelName="",n.sign.statusName="",n.sign.sureName="",n.$notify({title:"系统提示",message:"搜索结果为空",type:"info",duration:3e3}))}else n.$notify({title:"错误",message:e.data.meta.message,type:"error",duration:3e3})})}},getDeptCode:function(n){this.deptCode=this.applyCompanyList.find(function(e){return e.name===n})},exportExcel:function(){var n=this;if(0!==this.tableData3.length){var e=this,t=this.listQuery.date.substring(0,4),a=parseInt(this.listQuery.date.substring(5,7))+"",s=[];this.tableData3.forEach(function(e,i){if(0!==i&&void 0!==e.name){var r={};r.name=e.name,r.equipmentModel=e.equipmentModel,r.equipmentUnit=e.equipmentUnit,r.equipmentNum=parseInt(e.equipmentNum),r.sum=parseFloat(e.sum),r.remark=e.remark,r.equipmentCode=e.equipmentCode,r.feeDay=e.feeDay,r.feeSum=n.tableData3[0].sum,r.useDeptName=n.deptCode.name,r.useDeptCode=n.deptCode.deptCode,r.number=r.number,r.createExcelName=n.sign.createExcelName,r.statusName=n.sign.statusName,r.sureName=n.sign.sureName,r.useAt=e.useAt,r.equipmentPosition=e.equipmentPosition,r.useYear=t,r.useMonth=a,r.type=e.type,s.push(r)}});var r={equipmentLosses:s};Object(i.f)("/v1/eloss",{token:m,authorityCode:1},r,function(n){200===n.data.status?(e.excel(),e.$notify({title:"系统提示",message:"导出成功",type:"success",duration:3e3})):e.$notify({title:"错误",message:n.data.msg,type:"error",duration:3e3})})}},excel:function(){var n=c.a.utils.table_to_book(document.querySelector("#reportDiv")),e=c.a.write(n,{bookType:"xlsx",bookSST:!0,type:"array"});try{u.a.saveAs(new Blob([e],{type:"application/octet-stream"}),"设备非正常损失赔偿费表.xlsx")}catch(n){"undefined"!=typeof console&&console.log(n,e)}return e},reset:function(){this.listQuery.date="",this.listQuery.useDepartment="",this.tableData3=[]}},created:function(){this.getDeptList()},filters:{numFilter:function(n){var e=Number(n).toFixed(2),t=e.substring(0,e.length);return Number(t)}}},h={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container1"},[t("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{type:"month",placeholder:"选择年月","value-format":"yyyy-MM",format:"yyyy-MM"},model:{value:n.listQuery.date,callback:function(e){n.$set(n.listQuery,"date",e)},expression:"listQuery.date"}}),n._v(" "),t("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{filterable:"",clearable:"",placeholder:"选择单位"},on:{change:n.getDeptCode},model:{value:n.listQuery.useDepartment,callback:function(e){n.$set(n.listQuery,"useDepartment",e)},expression:"listQuery.useDepartment"}},n._l(n.applyCompanyList,function(n){return t("el-option",{key:n.deptCode,attrs:{label:n.name,value:n.name}})})),n._v(" "),t("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:n.search}},[n._v("搜索")]),n._v(" "),t("el-button",{staticClass:"filter-item",attrs:{size:"small",icon:"el-icon-refresh"},on:{click:n.reset}},[n._v("重置")]),n._v(" "),t("div",{staticClass:"btn_right"},[t("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"warning",icon:"el-icon-upload"},on:{click:n.exportExcel}},[n._v("导出")])],1)],1),n._v(" "),t("div",{staticClass:"table-center",attrs:{id:"reportDiv"}},[t("el-table",{staticClass:"fix-header",staticStyle:{width:"912px"},attrs:{fit:"","highlight-current-row":""}},[t("el-table-column",{attrs:{label:"设备非正常损失赔偿费表",align:"center"}},[t("el-table-column",{attrs:{label:"使用单位："+n.listQuery.useDepartment}})],1)],1),n._v(" "),t("el-table",{staticClass:"list-table",staticStyle:{width:"912px","max-height":"740px"},attrs:{data:n.tableData3,border:"",fit:"","highlight-current-row":""}},[t("el-table-column",{attrs:{width:"80px",align:"center",label:"工作面"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:!e.row.notShow,expression:"!scope.row.notShow"}],staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.equipmentPosition,callback:function(t){n.$set(e.row,"equipmentPosition",t)},expression:"scope.row.equipmentPosition"}}),n._v(" "),t("span",[n._v(n._s(e.row.equipmentPosition))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"180px",align:"center",label:"名称"},scopedSlots:n._u([{key:"default",fn:function(e){return[e.row.notShow?n._e():t("el-input",{staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.name,callback:function(t){n.$set(e.row,"name",t)},expression:"scope.row.name"}}),n._v(" "),t("span",[n._v(n._s(e.row.name))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"180px",align:"center",label:"规格型号"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:!e.row.notShow,expression:"!scope.row.notShow"}],staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.equipmentModel,callback:function(t){n.$set(e.row,"equipmentModel",t)},expression:"scope.row.equipmentModel"}}),n._v(" "),t("span",[n._v(n._s(e.row.equipmentModel))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"80px",align:"center",label:"单位"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:!e.row.notShow,expression:"!scope.row.notShow"}],staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.equipmentUnit,callback:function(t){n.$set(e.row,"equipmentUnit",t)},expression:"scope.row.equipmentUnit"}}),n._v(" "),t("span",[n._v(n._s(e.row.equipmentUnit))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"50px",align:"center",label:"数量",prop:"equipmentNum"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:!e.row.notShow,expression:"!scope.row.notShow"}],staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.equipmentNum,callback:function(t){n.$set(e.row,"equipmentNum",t)},expression:"scope.row.equipmentNum"}}),n._v(" "),t("span",[n._v(n._s(e.row.equipmentNum))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"100px",align:"center",label:"金额（元）"},scopedSlots:n._u([{key:"default",fn:function(e){return[e.row.notShow?n._e():t("el-input",{staticClass:"table-input",attrs:{type:"text"},on:{change:function(t){n.handleEdit(e.$index,e.row)}},model:{value:e.row.sum,callback:function(t){n.$set(e.row,"sum",t)},expression:"scope.row.sum"}}),n._v(" "),t("span",[n._v(n._s(e.row.sum))])]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"240px",align:"center",label:"备注"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:!e.row.notShow,expression:"!scope.row.notShow"}],staticClass:"table-input",attrs:{type:"text"},model:{value:e.row.remark,callback:function(t){n.$set(e.row,"remark",t)},expression:"scope.row.remark"}}),n._v(" "),t("span",[n._v(n._s(e.row.remark))])]}}])})],1),n._v(" "),t("el-row",[t("el-col",{staticClass:"set-color1"},[n._v("注：点击任意行填写数据，表中没有填写名称的数据，导出时将不会被保存。")])],1),n._v(" "),t("el-table",{staticClass:"fix-header",staticStyle:{width:"891px"},attrs:{data:n.tableData,"show-header":!1}},[t("el-table-column",{attrs:{width:"276px"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(e.row.name1))]),n._v(" "),t("span",{staticStyle:{display:"none"}},[n._v(n._s(n.sign.createExcelName))]),n._v(" "),t("el-input",{attrs:{type:"text"},model:{value:n.sign.createExcelName,callback:function(e){n.$set(n.sign,"createExcelName",e)},expression:"sign.createExcelName"}})]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"276px"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(e.row.name2))]),n._v(" "),t("span",{staticStyle:{display:"none"}},[n._v(n._s(n.sign.statusName))]),n._v(" "),t("el-input",{attrs:{type:"text"},model:{value:n.sign.statusName,callback:function(e){n.$set(n.sign,"statusName",e)},expression:"sign.statusName"}})]}}])}),n._v(" "),t("el-table-column",{attrs:{width:"336px"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(e.row.name3))]),n._v(" "),t("span",{staticStyle:{display:"none"}},[n._v(n._s(n.sign.sureName))]),n._v(" "),t("el-input",{attrs:{type:"text"},model:{value:n.sign.sureName,callback:function(e){n.$set(n.sign,"sureName",e)},expression:"sign.sureName"}})]}}])})],1)],1)])},staticRenderFns:[]};var f=t("VU/8")(d,h,!1,function(n){t("wQqH")},null,null);e.default=f.exports},wQqH:function(n,e,t){var a=t("xCfs");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("44396d92",a,!0)},xCfs:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/* 头部表名table无数据时不显示 暂无数据字样 */\n.fix-header .el-table__empty-block{\r\n    min-height: 0;\n}\n.fix-header span{\r\n    float: left;\r\n    line-height: 30px;\n}\n.fix-header .el-input{\r\n    float: left;\r\n    width: 180px;\n}\n.fix-header .el-input--medium .el-input__inner{\r\n    height: 30px;\r\n    line-height: 30px;\r\n    border: none;\r\n    padding: 0 10px;\n}\n.btn_right{\r\n      float: right;\n}\n.no-border-input .el-input__inner{\r\n      border-top: none;\r\n      border-left: none;\r\n      border-right: none;\r\n      border-radius: 0;\n}\n.table-center{\r\n      width: 920px;\r\n      margin: 0 auto;\n}\n.grid-content{\r\n      line-height: 35px;\n}\n.theader{\r\n      font-size: 1.2rem\n}\n.set-color1{\r\n      width: 912px;\r\n      padding: 15px;\r\n      color: #606266\n}\n.center{\r\n      text-align: center\n}\n.right{\r\n      text-align: right\n}\n.bottom-sign{\r\n      margin-top: 50px\n}\n.set-color1 .el-input--medium .el-input__inner{\r\n      height: 22px;\r\n      line-height: 22px;\r\n      border: none;\r\n      padding: 0 10px;\n}\r\n  /* 行内编辑 */\n.list-table .el-input {\r\n      display: none\n}\n.list-table .current-row .el-input {\r\n      display: block\n}\n.list-table .current-row .el-input + span {\r\n      display: none\n}\n.list-table .el-input--medium .el-input__inner{\r\n      height: 22px;\r\n      line-height: 22px;\r\n      padding: 0 10px;\n}\r\n    ",""])}});