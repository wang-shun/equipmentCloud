webpackJsonp([34],{QLdn:function(t,e,a){var i=a("VdXZ");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("36ee365e",i,!0)},VdXZ:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-table__empty-block{\r\n  min-height: 0;\n}\n.btn_right {\r\n    float: right;\n}\n.reportTitle {\r\n    font-size: 16px\n}\n.el-input--small .el-input__inner {\r\n  height: 22px;\r\n  line-height: 22px;\n}\n.expDiv {\r\n    border: 1px solid #ebeef5;\r\n    height: 55px;\r\n    border-top: none;\n}\n.el-textarea__inner {\r\n    border: none !important;\r\n    width: 99%;\n}\r\n",""])},ZBC7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("cAgV"),s=a("lDdF"),r=a.n(s),l=a("uXZL"),n=a.n(l),o=a("ZjsX"),u=a("7t+N"),c=a.n(u),d=sessionStorage.getItem("token"),p=[{label:"是",value:"1"}],y={name:"repairCost",directives:{waves:i.a},data:function(){return{tableHeight:document.body.clientHeight-230,listQuery:{date:"",isBB:"",isdate:"",yeardate:""},colunmName:[],repairCostData:[],isBBList:p,temp:{exp:""}}},mounted:function(){this.sfoutdate()},watch:{"listQuery.date":function(t,e){this.listQuery.date?(this.listQuery.isdate=this.listQuery.date.split("-")[1],this.listQuery.yeardate=this.listQuery.date.split("-")[0],"0"===this.listQuery.isdate.substring(0,1)?this.listQuery.isdate=this.listQuery.isdate.substring(1,2):this.listQuery.isdate=this.listQuery.date.split("-")[1]):""!==this.listQuery.date&&null!==this.listQuery.date||(this.listQuery.isdate="",this.listQuery.yeardate="")}},methods:{sfoutdate:function(){var t=(new Date).getDate();t>=21&&t<=31?c()("#resetjs").show():c()("#resetjs").hide()},exportExcel:function(){var t=this,e=t.repairCostData;0===t.repairCostData.length?t.$notify({title:"系统提示",message:"导出报表不能为空",type:"warning",duration:2e3}):Object(o.f)("/v1/elFeePositionT",{token:d,authorityCode:1},e,function(e){if(200===e.data.status){var a=n.a.utils.table_to_book(document.querySelector("#reportDiv")),i=n.a.write(a,{bookType:"xlsx",bookSST:!0,type:"array"});try{r.a.saveAs(new Blob([i],{type:"application/octet-stream"}),"综机折旧修理费月报.xlsx")}catch(t){"undefined"!=typeof console&&console.log(t,i)}return t.$notify({title:"系统提示",message:"报表导出成功",type:"success",duration:2e3}),i}t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:2e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"报表导出失败",type:"error",duration:2e3})})},arraySpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;if(e===this.repairCostData.length-1){if(1===a)return[1,2];if(0===a)return[0,0]}},search:function(){var t=this;t.colunmName=[],t.repairCostData=[],Object(o.d)("/v1/elFeePositionT",{token:d,authorityCode:1},{exportAtStr:t.listQuery.date,poStatus:t.listQuery.isBB},function(e){if(200===e.data.status){var a=e.data.data;if(a){for(var i=0;i<a[0].depositList.length;i++)t.colunmName.push(a[0].depositList[i].key);for(var s={},r=0;r<a.length;r++)"0000"===a[r].middleCode&&(s=a[r],a.splice(r,1));a.push(s),t.repairCostData=a}else t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:2e3})}else t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:2e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"系统错误",type:"error",duration:2e3})})},recalculate:function(){var t=this;t.colunmName=[],t.repairCostData=[];var e={exportAtStr:t.listQuery.date,poStatus:t.listQuery.isBB};Object(o.d)("/v1/elFeePositionT/refresh",{token:d,authorityCode:1},e,function(e){if(200===e.data.status){var a=e.data.data;if(a){for(var i=0;i<a[0].depositList.length;i++)t.colunmName.push(a[0].depositList[i].key);for(var s={},r=0;r<a.length;r++)"0000"===a[r].middleCode&&(s=a[r],a.splice(r,1));a.push(s),t.repairCostData=a}else t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:2e3})}else t.$notify({title:"系统提示",message:e.data.msg,type:"warning",duration:2e3})},function(e){console.log(e),t.$notify({title:"系统提示",message:"重新计算失败",type:"warning",duration:2e3})})},reset:function(){this.listQuery.date="",this.listQuery.isBB="",this.repairCostData=[]}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{type:"month","value-format":"yyyy-MM",format:"yyyy-MM",placeholder:"选择年月"},model:{value:t.listQuery.date,callback:function(e){t.$set(t.listQuery,"date",e)},expression:"listQuery.date"}}),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{filterable:"",clearable:"",placeholder:"是否本部"},model:{value:t.listQuery.isBB,callback:function(e){t.$set(t.listQuery,"isBB",e)},expression:"listQuery.isBB"}},t._l(t.isBBList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-edit",id:"resetjs"},on:{click:t.recalculate}},[t._v("重新计算")]),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"small",icon:"el-icon-refresh"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),a("div",{staticClass:"btn_right"},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"warning",icon:"el-icon-upload"},on:{click:t.exportExcel}},[t._v("导出")])],1)],1),t._v(" "),a("div",{attrs:{id:"reportDiv"}},[a("el-table",{ref:"moviesTable",staticStyle:{width:"100%","max-height":"740px"},attrs:{data:t.repairCostData,border:"","highlight-current-row":"","span-method":t.arraySpanMethod,height:t.tableHeight}},[a("el-table-column",{attrs:{align:"center",label:this.listQuery.yeardate+"年通用设备折旧修理费月报（本部七矿） ---"+this.listQuery.isdate+"月份"}},[a("el-table-column",{attrs:{align:"right",label:t.listQuery.date}},[a("el-table-column",{attrs:{type:"index",width:"50px",align:"center",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{width:"150px",align:"center",label:"设备中类"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.middleName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"矿处单位"}},t._l(t.colunmName,function(e,i){return a("el-table-column",{key:i,attrs:{width:"150px",align:"center",label:e},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.depositList[i].value))])]}}])})})),t._v(" "),a("el-table-column",{attrs:{width:"150px",align:"center",label:"小计"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.totalFee))])]}}])})],1)],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"left",label:"备注：以上中类汇总含新投入设备管理费用"}})],1)],1)])},staticRenderFns:[]};var f=a("VU/8")(y,h,!1,function(t){a("QLdn")},null,null);e.default=f.exports}});